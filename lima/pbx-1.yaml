# Lima VM configuration for pbx-1
# Generated by lima-vms.sh

# Use Debian 12 (Bookworm) ARM64
images:
  - location: "https://cloud.debian.org/images/cloud/bookworm/latest/debian-12-generic-arm64.qcow2"
    arch: "aarch64"

# VM resources
cpus: 2
memory: "4GiB"
disk: "20GiB"

# Use QEMU with Apple Hypervisor Framework
vmType: "qemu"

# Network configuration - use user-mode networking (no root/sudo required)
networks: []

# SSH configuration
ssh:
  localPort: 0  # Auto-assign port
  loadDotSSHPubKeys: true

# Mount configuration - minimal for server VMs
mounts: []

# Provision script - basic setup
provision:
  - mode: system
    script: |
      #!/bin/bash
      set -eux

      # Update and install essentials
      apt-get update
      apt-get install -y curl wget vim htop net-tools dnsutils python3 python3-apt

      # Set hostname
      hostnamectl set-hostname pbx-1

      echo "VM pbx-1 provisioned successfully"

# Message shown after VM starts
message: |
  VM 'pbx-1' is ready!

  Shell access: limactl shell pbx-1
  SSH access:   ssh -F ~/.lima/pbx-1/ssh.config lima-pbx-1
